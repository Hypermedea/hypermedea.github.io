<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>HypermedeaEnvironment (hypermedea-lib 0.5 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: org.hypermedea, class: HypermedeaEnvironment">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.hypermedea</a></div>
<h1 title="Class HypermedeaEnvironment" class="title">Class HypermedeaEnvironment</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">jason.environment.Environment
<div class="inheritance">org.hypermedea.HypermedeaEnvironment</div>
</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">HypermedeaEnvironment</span>
<span class="extends-implements">extends jason.environment.Environment</span></div>
<div class="block"><p>
   The Hypermedea environment turns agent actions into requests to servers and processes any
   incoming response (synchronous or asynchronous). It also manages a collection of resource
   representations available to all agents as percepts.
 </p>
 <p>
   A typical MAS project file (.mas2j) will be as follows:
 </p>
 <pre><code>MA example_mas {

   environment: org.hypermedea.HypermedeaEnvironment

   agents: example_web_agent;

   aslSourcePath: "src";

 }</code></pre>
 <p>
   Operations available to <code>example_web_agent</code> are
   <code>get</code>,
   <code>watch</code>,
   <code>forget</code>,
   <code>put</code>,
   <code>post</code>,
   <code>patch</code> and
   <code>delete</code>.
 </p>
 <p>
   Safe operations (<code>get</code>, <code>watch</code>, <code>forget</code>)
   and <code>delete</code> only require a URI as input. Other operations must also
   have a resource representation as input, represented in AgentSpeak as a literal
   or a list of literals (see <a href="ct/RepresentationHandler.html" title="interface in org.hypermedea.ct"><code>RepresentationHandler</code></a> for more details).
 </p>
 <p>
   All operations have in common that they also accept a <em>form</em> as input, i.e.
   a set of arbitrary property/value pairs (called form fields). In AgentSpeak,
   a form is represented as a <code>MapTerm</code>. It may be used to provide further
   arguments to the operation, such as custom headers, or to provide
   protocol-specific information, such as an MQTT Quality of Service (QoS) level
   or a ROS message type. All operations also have an alternative signature
   without form, which is equivalent to executing the operation with an empty form.
 </p>
 <h2 id="get-resourceuri-formfields--heading">get(resourceURI, formFields)</h2>
 <p>
   Asks the server for a representation of <code>resourceURI</code>. Once a response is
   received from the server, its payload is exposed as a (list of) AgentSpeak literal(s)
   before returning. The calling agent can thus safely query the resource's
   representation after the call returns, as follows:
 </p>
 <pre><code>+!retrieve_then_query(URI) &lt;-
  h.target(URI, TargetURI) ;
  get(URI) ;
  for (rdf(URI, P, O)[source_uri(TargetURI)]) {
    .print("Found: ", P, O)
  } .</code></pre>
 <p>
   Any piece of representation found in the server's response will be turned into a
   literal with a <code>source_uri</code> annotation. In some cases, the URI provided by the
   agent may not be the exact target used to request the server (URI fragments are
   stripped away). This is why Hypermedea also provides the <a href="../../h/target.html" title="class in h"><code>target</code></a> internal
   action to extract the corresponding target from any URI.
 </p>
 <p>
   Note that a resource representation may correspond to one or more literals,
   depending on the response payload's Content-Type. In RDF, it is indeed more
   convenient for programmers to have access to RDF triples individually rather than
   as members of a list, whereas in JSON, there is a single literal with a
   tree-shaped structure. See <a href="ct/package-summary.html"><code>ct</code></a> for details on
   representation handlers.
 </p>
 <h2 id="watch-resourceuri-formfields--heading">watch(resourceURI, formFields)</h2>
 <p>
   Subscribes to any change in the representation of <code>resourceURI</code>, to be sent asynchronously
   by the server. Not all protocols may support this operation type. Plain HTTP, for instance, doesn't.
 </p>
 <p>
   In contrast to a <code>get</code> operation, the call may return before having
   received any representation from the server. The call returns as soon as the server confirms the
   request has been processed (or, if the underlying protocol has no acknowledgement mechanism, it
   returns immediately). The caller agent should therefore wait for events corresponding to
   server notifications, as follows:
 </p>
 <pre><code>+!watch_only(URI) &lt;-
  h.target(URI, TargetURI) ;
  watch(URI) ;
  +watching(TargetURI) .

+rdf(S, P, O)[source_uri(TargetURI)] : watching(TargetURI) &lt;-
  .print("Received: ", S, P, O) .</code></pre>
 <p>
   or, if a single notification is enough:
 </p>
 <pre><code>+!watch_then_wait(URI) &lt;-
  h.target(URI, TargetURI) ;
  watch(URI) ;
  .wait({ +(json(Val)[source_uri(TargetURI)] }) ;
  .print("Received: ", Val) .</code></pre>
 <p>
   In the above example, the agent must know in advance what Content-Type to expect. Certain
   protocol bindings have limitations as to what Content-Type can be exchanged with the server.
   In case the server supports it, though, the agent may leverage
   <a href="https://en.wikipedia.org/wiki/Content_negotiation">content negotiation</a>
   to request the server to return a specific Content-Type.
 </p>
 <p>
   <a href="../../h/target.html" title="class in h"><code>target</code></a> is a Hypermedea internal action, <code>wait</code> is part of the
   <a href="https://jason-lang.github.io/api/jason/stdlib/package-summary.html">Jason standard library</a>.
 </p>
 <h2 id="forget-resourceuri-formfields--heading">forget(resourceURI, formFields)</h2>
 <p>
   Deletes the local representation of <code>resourceURI</code> and, if the resource is being watched,
   unsubscribes from server notification. No future change on <code>resourceURI</code> will be notified
   to agents.
 </p>
 <h2 id="put-resourceuri-representation-formfields--heading">put(resourceURI, representation, formFields)</h2>
 <p>
   Asks the server to replace the current representation(s) it has of <code>resourceURI</code> with
   the provided <code>representation</code>. This parameter must be provided as a (list of) Jason
   literal(s), in order to be serialized in a standard format by the proper representation
   handler (see package <a href="ct/package-summary.html"><code>ct</code></a>).
 </p>
 <p>
   After the call returns, the caller agent may assume the new representation of <code>resourceURI</code>
   on server side is the provided one. There is however no strict guarantee. The server may also
   alter this representation, e.g. to maintain consistency with other resources it manages or to add
   metadata (modification date, author, etc.). This is why Hypermedea makes no assumption about what
   the new representation is. If the caller agent wants to cache the new representation, it
   should execute a <code>get</code> operation right after <code>put</code>, as follows:
 </p>
 <pre><code>+!put_then_get(URI) &lt;-
  h.target(URI, TargetURI) ;
  put(URI, [json(5)]) ;
  get(URI) ;
  // the artifact then exposes json(5)[source_uri(TargetURI)]
  // or, for instance, json({ value -&gt; 5, modified -&gt; 1700304346 })[source_uri(TargetURI)]
  .</code></pre>
 <p>
   By default, the Hypermedea artifact deletes the outdated representation of <code>resourceURI</code>
   when the call returns.
 </p>
 <h2 id="post-resourceuri-representationpart-formfields--heading">post(resourceURI, representationPart, formFields)</h2>
 <p>
   Asks the server to append the provided <code>representationPart</code> to the current representation
   of <code>resourceURI</code>. As for <code>put</code>, it is not guaranteed
   that the server does exactly what the agent asked. It may remove other parts of the representation
   to maintain consistency or add more information to it.
 </p>
 <p>
   Notably, a server may also create a new resource as a side effect of the operation. This new
   resource should either be linked from the (new) representation of <code>resourceURI</code>, if its
   Content-Type supports hypermedia, or be exposed in a message header, hidden by the protocol binding.
   For instance, in response to a POST request, an HTTP server may return a <code>201 Created</code>
   response that includes a Location header pointing to the new resource. To expose this
   information to the caller agent, Hypermedea builds an RDF triple from the location header and
   adds it to the representation of <code>resourceURI</code>. The agent may then query that RDF triple,
   as follows:
 </p>
 <pre><code>+!post_then_follow_link(URI) &lt;-
  h.target(URI, TargetURI) ;
  post(URI, [json(5)]) ;
  ?(rdf(TargetURI, "related", CreatedResourceURI)) ;
  .print("Created resource: ", CreatedResourceURI) ;
  h.target(CreatedResourceURI, CreatedTargetURI) ;
  get(CreatedResourceURI) ;
  ?(json(Val)[source(CreatedTargetURI)]) ;
  .print(Val) . // should include "5"</code></pre>
 <p>
   In the above example, the <code>related</code> predicate is set by default. However, in some cases,
   protocol bindings may choose a more precise predicate, if the context permits it (for instance
   <a href="http://purl.org/dc/terms/hasPart"><code>dct:hasPart</code></a>).
 </p>
 <p>
   Note that, as for <code>put</code>, if Hypermedea had
   a representation of <code>resourceURI</code> before the operation, this representation is deleted
   when the call returns.
 </p>
 <h2 id="patch-resourceuri-representationdiff-formfields--heading">patch(resourceURI, representationDiff, formFields)</h2>
 <p>
   Asks the server to apply a diff on the current representation of <code>resourceURI</code>, as specified
   in <code>representationDiff</code>. A diff should specify what parts to remove and what parts to add
   to the representation. Examples of diff formats include SPARQL Update and Git diff (for text files).
 </p>
 <p>
   <em>Not fully implemented yet</em>.
 </p>
 <h2 id="delete-resourceuri-formfields--heading">delete(resourceURI, formFields)</h2>
 <p>
   Asks the server to delete all known representations of <code>resourceURI</code>. Hypermedea
   also deletes all representations locally (if the operation succeeds), as there is no
   ambiguity as to what should happen on the server. However, other resources may have
   altered representations after the operation, which agents are unaware of. For instance,
   the server might delete all references of the resource in the representation of other
   resources it manages.
 </p></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#SOURCE_FUNCTOR" class="member-name-link">SOURCE_FUNCTOR</a></code></div>
<div class="col-last even-row-color">
<div class="block">note: <code>source</code> is a reserved annotation in Jason; using <code>source_uri</code> instead.</div>
</div>
</div>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-jason.environment.Environment">Fields inherited from class&nbsp;jason.environment.Environment</h3>
<code>executor</code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">HypermedeaEnvironment</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#executeAction(java.lang.String,jason.asSyntax.Structure)" class="member-name-link">executeAction</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;agName,
 jason.asSyntax.Structure&nbsp;act)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#stop()" class="member-name-link">stop</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-jason.environment.Environment">Methods inherited from class&nbsp;jason.environment.Environment</h3>
<code>addPercept, addPercept, clearAllPercepts, clearPercepts, clearPercepts, consultPercepts, containsPercept, containsPercept, getEnvironmentInfraTier, getLogger, getPercepts, informAgsEnvironmentChanged, informAgsEnvironmentChanged, init, isRunning, removePercept, removePercept, removePerceptsByUnif, removePerceptsByUnif, scheduleAction, setEnvironmentInfraTier</code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="SOURCE_FUNCTOR">
<h3>SOURCE_FUNCTOR</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">SOURCE_FUNCTOR</span></div>
<div class="block">note: <code>source</code> is a reserved annotation in Jason; using <code>source_uri</code> instead.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../../constant-values.html#org.hypermedea.HypermedeaEnvironment.SOURCE_FUNCTOR">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>HypermedeaEnvironment</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">HypermedeaEnvironment</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="executeAction(java.lang.String,jason.asSyntax.Structure)">
<h3>executeAction</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">executeAction</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;agName,
 jason.asSyntax.Structure&nbsp;act)</span></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code>executeAction</code>&nbsp;in class&nbsp;<code>jason.environment.Environment</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stop()">
<h3>stop</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">stop</span>()</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code>stop</code>&nbsp;in class&nbsp;<code>jason.environment.Environment</code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
